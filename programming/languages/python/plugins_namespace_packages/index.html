<!doctype html><html lang="en"><title>exobrain | Python Plugins/Namespace Packages</title><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><meta http-equiv="Cache-Control"content="no-cache, no-store, must-revalidate"><link rel="shortcut icon"href="/assets/img/logo.png"type="image/png"><meta http-equiv="Pragma"content="no-cache"><meta http-equiv="Expires"content="0"><link rel="stylesheet"href="/assets/style.css"><header class="nav-bar"><nav><a class="homelink"href="/">exobrain</a><div class="nav-right"><div class="nav-item"><a class="nav-link"href="/search">[search]</a></div><div class="nav-item"><a class="nav-link"href="/feed">[feed]</a></div><div class="nav-item"><a class="nav-link"href="/sitemap">[sitemap]</a></div><div class="nav-item"><a class="nav-link"href="https://sean.fish">back to my site</a></div></div></nav></header><main><div class="container"><div id="main-header"><div class="h1"id="main-title">Python Plugins/Namespace Packages</div></div><p>My <a href="https://github.com/seanbreckenridge/HPI">HPI</a> repo is an example of using <a href="https://packaging.python.org/guides/creating-and-discovering-plugins/#using-namespace-packages">namespace packages as an plugin mechanism</a>.<p>Both of them are installed as an editable package (like <code>pip install -e .</code>, which adds a <code>egg</code> file to <code>~/.local/lib/python3.9/site-packages/</code>, and a line to <code>~/.local/lib/python3.9/site-packages/easy-install.pth</code>.<p>Upsides:<ul><li>Any changes to either repo immediately update the local packages, no need to reinstall/re-run <code>setup.py</code>.<li>Relative imports work across directory structures, no need to symlink.</ul><p>Downsides:<ul><li>Requires quite a bit of domain knowledge on python packaging and troubleshooting to get work<li>How name conflicts (i.e. if my HPI fork had a <code>my.location</code> subpackage and so did the upstream HPI, which are both installed as a namespace package) are handled are by the order of the paths in the <code>easy-install.pth</code>, e.g.:</ul><div class="sourceCode"id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"aria-hidden="true"tabindex="-1"></a><span class="fu">cat</span> ~/.local/lib/python3.9/site-packages/easy-install.pth</span>
<span id="cb1-2"><a href="#cb1-2"aria-hidden="true"tabindex="-1"></a><span class="ex">/home/sean/Repos/HPI</span></span>
<span id="cb1-3"><a href="#cb1-3"aria-hidden="true"tabindex="-1"></a><span class="ex">/home/sean/Repos/HPI-to-master</span></span></code></pre></div><p>means that <code>HPI</code> overrides any namespace packages in <code>HPI-to-master</code>.<p>The fact that it overrides is great! Since it means I can overwrite files in the upstream repo without having to maintain a fork and having to deal with merging changes back and forth. But, sometimes when re-installing (or for some reason I can’t seem to find) <code>easy-install.pth</code> gets messed with, and I have to manually fix it. Perhaps a tool should be written to handle this…</div></main><footer><p><a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode"id="copyright">© 2020 Sean Breckenridge. Licensed under Creative Commons Attribution-ShareAlike.</a><br><a href="https://github.com/seanbreckenridge/exobrain">Source Code</a></footer><script src="/assets/main.js"></script>