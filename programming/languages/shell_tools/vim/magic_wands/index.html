<!doctype html><html lang="en"><title>exobrain | Magic Wands</title><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><meta http-equiv="Cache-Control"content="no-cache, no-store, must-revalidate"><link rel="shortcut icon"href="/assets/img/logo.png"type="image/png"><meta http-equiv="Pragma"content="no-cache"><meta http-equiv="Expires"content="0"><meta property="ba:title"content="back to my website"><meta property="ba:url"content="https://sean.fish"><meta property="ba:color"content="#999"><link rel="stylesheet"href="/assets/style.css"><header class="nav-bar"><nav><a class="homelink"href="/">exobrain</a><div class="nav-right"><div class="nav-item"><a class="nav-link"href="/search">[search]</a></div><div class="nav-item"><a class="nav-link"href="/feed">[feed]</a></div><div class="nav-item"><a class="nav-link"href="/sitemap">[sitemap]</a></div><div class="nav-item"><a class="nav-link"href="https://sean.fish">back to my site</a></div></div></nav></header><main><div class="container"><div id="main-header"><div class="h1"id="main-title">Magic Wands</div></div><p>Use <code>magic wands</code>! They’re awesome. Learnt about them from <a href="https://rwx.gg"><code>rwx.gg</code></a> (the <code>magic wands</code> is his term)<p>The vi term is <code>cmdline-ranges</code>, see <code>:help cmdline-ranges</code><p>See <a href="https://rwx.gg/tools/editors/vi/how/magic/"class="uri">https://rwx.gg/tools/editors/vi/how/magic/</a><p>In command mode, you can hit <code>!!</code> twice, to bring up a prompt which will send the current line to some external command.<p>For example, if you write:<p><code>which docker-compose</code><p>and then on that line, type <code>!!bash</code>, it’ll send that to bash, and replace the current line with the output of that command.<p><code>/home/sean/.local/bin/docker-compose</code><p>Could just as easily send some snippet of code to python or perl, or <em>anything</em>.<ul><li><code>:.$ to run vim commands</code><li><code>:.! to run external commands</code></ul><p>This doesn’t have to be on single lines though, you can do <code>6!!</code> to send 6 lines to some external command.<p>As an example for vim commands, the keystrokes you’d have to do to write 5 lines to another file would be:<p><code>5!!&lt;delete&gt;$:w /tmp/output</code><p>the <code>delete</code> is to replace the <code>!</code> (external vim command) to a <code>$</code>, which specifies a vim command.<p>The line would look like:<p><code>:.,.+4$:w /tmp/foo</code><p>The complicated <code>.,.+4</code> is generated by vim when you do <code>!!5</code>, <code>$:w /tmp/foo</code> is the command I typed in.<p>I have a script called <code>ix</code> <a href="https://github.com/seanbreckenridge/core/blob/main/shellscripts/ix">here</a> which accepts some text as STDIN and makes an <code>ix</code> (pastebin), so I can do something like:<p><code>5!!ix -v</code> (which becomes <code>:.,.+4!ix -v</code>)<p>.. which takes those 5 lines and uploads them to <code>ix</code>, copying a link to that paste to my clipboard, without ever leaving <code>vim</code>!<p>While not a feature in <code>vi</code>, in <code>vim</code> and <code>neovim</code>, this also works with visual mode, so say you had two commands:<pre><code>date
cal</code></pre><p>If you go into visual line mode (<code>V</code>) and select both lines, then hit <code>!</code>, the become<p><code>'&lt;,'&gt;!</code> – which represents your selection<p>By sending that to bash:<p><code>&lt;,'&gt;!bash</code><pre><code>Sat Mar 12 02:19:04 PM PST 2022
     March 2022
Su Mo Tu We Th Fr Sa
       1  2  3  4  5
 6  7  8  9 10 11 12
13 14 15 16 17 18 19
20 21 22 23 24 25 26
27 28 29 30 31</code></pre></div></main><footer><p><a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode"id="copyright">© 2022 Sean Breckenridge. Licensed under Creative Commons Attribution-ShareAlike.</a><br><a href="https://github.com/seanbreckenridge/exobrain">Source Code</a></footer><script src="/assets/main.js"></script><script src="https://sean.fish/p/back-arrow-bundle.js"></script>