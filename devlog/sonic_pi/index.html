<!doctype html><html lang="en"><title>exobrain | Sonic-Pi</title><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible"content="ie=edge"><meta http-equiv="Cache-Control"content="no-cache, no-store, must-revalidate"><link rel="shortcut icon"href="/assets/img/logo.png"type="image/png"><meta http-equiv="Pragma"content="no-cache"><meta http-equiv="Expires"content="0"><link rel="stylesheet"href="/assets/style.css"><header class="nav-bar"><nav><a class="homelink"href="/">exobrain</a><div class="nav-right"><div class="nav-item"><a class="nav-link"href="/feed">blog feed</a></div><div class="nav-item"><a class="nav-link"href="/sitemap">exobrain sitemap</a></div><div class="nav-item"><a class="nav-link"href="https://sean.fish">back to my site</a></div></div></nav></header><main><a id="top"></a><div class="container"><div id="main-header"><div class="h1"id="main-title">Sonic-Pi</div></div><p>Issues installing <a href="https://github.com/sonic-pi-net/sonic-pi/blob/main/INSTALL-LINUX.md"><code>sonic-pi</code></a> on arch.<p>The default <code>sonic-pi</code> package from community failed to launch because of JACK errors; <a href="https://gist.github.com/seanbreckenridge/99fa2e3d94d30b3193a903634990f06f">errorlog</a><pre><code>JACK is running in realtime mode, but you are not allowed to use realtime scheduling.
Please check your /etc/security/limits.conf for the following line
and correct/add it if necessary:

  @audio          -       rtprio          99

After applying these changes, please re-login in order for them to take effect.

You don&#39;t appear to have a sane system configuration. It is very likely that you
encounter xruns. Please apply all the above mentioned changes and start jack again!
connect(2) call to /dev/shm/jack-1000/default/jack_0 failed (err=No such file or directory)

JACK is running in realtime mode, but you are not allowed to use realtime scheduling.
Please check your /etc/security/limits.conf for the following line
and correct/add it if necessary:

  @audio          -       rtprio          99

After applying these changes, please re-login in order for them to take effect.``</code></pre><p>After adding that line to <code>/etc/security/limits.conf</code> and restarting, it errored with:<pre><code>JACK is running in realtime mode, but you are not allowed to use realtime scheduling.

Your system has an audio group, but you are not a member of it.
Please add yourself to the audio group by executing (as root):
  usermod -a -G audio sean</code></pre><p>So, I ran: <code>sudo usermod -aG audio "$(whoami)"</code><p>Should be noted that the <a href="https://wiki.archlinux.org/index.php/JACK_Audio_Connection_Kit">arch wiki</a> says to instead manually add your user to the <code>realtime</code> group, but sonic-pi needs you to be running this manually, so, not going to do that.<p>After restarting:<pre><code>$ groups
docker users video audio wheel</code></pre><p>After that, running <code>sonic-pi</code> causes this error:<pre><code>connect(2) call to /dev/shm/jack-1000/default/jack_0 failed (err=No such file or directory)
could not open driver .so &#39;/usr/lib/jack/jack_net.so&#39;: libcelt0.so.2: cannot open shared object file: No such file or directory

could not open driver .so &#39;/usr/lib/jack/jack_firewire.so&#39;: libffado.so.2: cannot open shared object file: No such file or directory</code></pre><p>Should be noted I use <code>pulseaudio</code> instead of <code>alsa</code>. Seems that <code>JACK</code> works better with <code>alsa</code> (i.e. it has a backend for it, see <code>man jackd</code>.<p>I found the solution to this on <a href="https://github.com/sonic-pi-net/sonic-pi/issues/1908">this</a> issue; which is to run:<pre><code>jackd -R -d alsa -d hw:1  # in another terminal
sonic-pi</code></pre><p>Made this into a script:<pre><code>#!/bin/bash

jackd -R -d alsa -d hw:1 &amp;
sonic-pi # block

kill $(jobs -p)</code></pre><p>I’m not totally clear on <em>why</em> this works, because I do believe I’m using <code>pulseaudio</code> and not <code>alsa</code>, but it does. The output still has the error from above, but it seems the <code>jackd</code> that is run manually communicates with <code>sonic-pi</code> instead of a daemon running in the background:<pre><code>$ ./sonic-pi-run
jackd 0.125.0
Copyright 2001-2009 Paul Davis, Stephane Letz, Jack O&#39;Quinn, Torben Hohn and others.
jackd comes with ABSOLUTELY NO WARRANTY
This is free software, and you are welcome to redistribute it
under certain conditions; see the file COPYING for details

could not open driver .so &#39;/usr/lib/jack/jack_net.so&#39;: libcelt0.so.2: cannot open shared object file: No such file or directory

could not open driver .so &#39;/usr/lib/jack/jack_firewire.so&#39;: libffado.so.2: cannot open shared object file: No such file or directory

JACK compiled with System V SHM support.
cannot lock down memory for jackd (Cannot allocate memory)
loading driver ..
creating alsa driver ... hw:1|hw:1|1024|2|48000|0|0|nomon|swmeter|-|32bit
configuring for 48000Hz, period = 1024 frames (21.3 ms), buffer = 2 periods
ALSA: final selected sample format for capture: 32bit integer little-endian
ALSA: use 2 periods for capture
ALSA: final selected sample format for playback: 32bit integer little-endian
ALSA: use 2 periods for playback
JACK: unable to mlock() port buffers: Cannot allocate memory
Attribute Qt::AA_EnableHighDpiScaling must be set before QCoreApplication is created.
[GUI] - reading settings

&lt;I EXITED SONIC PI HERE&gt;

Shutting down audio thread
subgraph starting at SuperCollider timed out (subgraph_wait_fd=9, status = 0, state = Triggered, pollret = 0 revents = 0x0)

**** alsa_pcm: xrun of at least 31682.032 msecs

jack main caught signal 15</code></pre><p>References:<p><a href="https://github.com/sonic-pi-net/sonic-pi/issues/849"class="uri">https://github.com/sonic-pi-net/sonic-pi/issues/849</a> <a href="https://www.miskatonic.org/2015/01/17/setting-up-sonic-pi-on-ubuntu/"class="uri">https://www.miskatonic.org/2015/01/17/setting-up-sonic-pi-on-ubuntu/</a> <a href="https://github.com/sonic-pi-net/sonic-pi/issues/1908"class="uri">https://github.com/sonic-pi-net/sonic-pi/issues/1908</a></div></main><footer><p><a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode"id="copyright">© 2020 Sean Breckenridge. Licensed under Creative Commons Attribution-ShareAlike.</a><br><a href="https://github.com/seanbreckenridge/exobrain">Source Code</a></footer><script src="/assets/main.js"></script>