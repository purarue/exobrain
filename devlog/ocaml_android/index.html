<!doctype html><html lang="en"><title>exobrain | Opam on Android</title><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><meta http-equiv="Cache-Control"content="no-cache, no-store, must-revalidate"><link rel="shortcut icon"href="/assets/img/logo.png"type="image/png"><meta http-equiv="Pragma"content="no-cache"><meta http-equiv="Expires"content="0"><meta property="ba:title"content="back to my website"><meta property="ba:url"content="https://sean.fish"><meta property="ba:color"content="#999"><link rel="stylesheet"href="/assets/style.css"><header class="nav-bar"><nav><a class="homelink"href="/">exobrain</a><div class="nav-right"><div class="nav-item"><a class="nav-link"href="/search">[search]</a></div><div class="nav-item"><a class="nav-link"href="/feed">[feed]</a></div><div class="nav-item"><a class="nav-link"href="/sitemap">[sitemap]</a></div><div class="nav-item"><a class="nav-link"href="https://sean.fish">back to my site</a></div></div></nav></header><main><div class="container"><div id="main-header"><div class="h1"id="main-title">Opam on Android</div><div class="title-date">2023/09/17</div></div><p><a href="https://github.com/ocaml/dune/issues/8676">Related issue on dune</a><p>Prereqs:<pre><code>pkg install rsync clang coreutils dash diffutils make nc</code></pre><ul><li>Install the <a href="https://wiki.termux.com/wiki/Package_Management">its-pointless community repo</a></ul><pre><code>curl -LO https://its-pointless.github.io/setup-pointless-repo.sh
bash setup-pointless-repo.sh</code></pre><ul><li>Install opam</ul><pre><code>pkg install opam</code></pre><p>I just ran <code>opam init --bypass-checks --disable-sandboxing</code> which sets up the basic <code>~/.opam</code> directory (but eventually fails). That asks you to clean up the broken switch (version), so I did.<p>Then, following the debugging <a href="https://github.com/ocaml/opam-repository/issues/22748">here</a>:<p>Edit your <code>~/.opam/config</code> and reduce <code>jobs</code> to 1, and remove the <code>wrap-*</code> lines (that does the sandboxing with bubblewrap, which I couldn’t figure out how to install)<p>Mine looks like:<pre><code>opam-version: &quot;2.0&quot;
repositories: &quot;default&quot;
installed-switches: [&quot;5.0.0&quot; &quot;default&quot;]
switch: &quot;5.0.0&quot;
jobs: 1
download-jobs: 3
eval-variables: [
  sys-ocaml-version
  [&quot;ocamlc&quot; &quot;-vnum&quot;]
  &quot;OCaml version present on your system independently of opam, if any&quot;
]
default-compiler: [
  &quot;ocaml-system&quot; {&gt;= &quot;4.02.3&quot;}
  &quot;ocaml-base-compiler&quot;
]</code></pre><p>Then, <code>export LDFLAGS="-landroid-shmem"</code> and <code>opam switch create 5.0.0 --jobs=1</code><p>A then just wait a while for it to build.</div></main><footer><p><a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode"id="copyright">© 2022 Sean Breckenridge. Licensed under Creative Commons Attribution-ShareAlike.</a><br><a href="https://github.com/seanbreckenridge/exobrain">Source Code</a></footer><script src="/assets/main.js"></script><script src="https://sean.fish/p/back-arrow-bundle.js"></script>